<!doctype html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Dashboard Turismo 2023-2030</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
  </head>
  <body>
    <div class="app-container" id="appContainer">
      <!-- SIDEBAR FILTRI -->
      <aside class="sidebar-left collapsed" id="sidebarLeftFilter">
        <div class="sidebar-header">
                <div class="brand-title">
                    <div class="brand-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 3v18h18"/><path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"/></svg></div>
                    TRENTINO DATA
                </div>
                <button class="reset-btn" onclick="setDefaultFilter()">
                    <svg class="icon reset-icon" viewBox="0 0 24 24"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
                    Reset
                </button>
            </div>
            
            <div class="sidebar-content" id="filtersContainer">
      </aside>

      <!-- SIDEBAR GENERAZIONE -->
      <aside class="sidebar-left collapsed" id="sidebarLeftGenerate">
        <div class="sidebar-header">
          <div class="brand-title">
            <div class="brand-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M22 3H2l8 9.46V19l4 2v-8.54L22 3z"></path>
              </svg>
            </div>
            TRENTINO FORECAST
          </div>
          <button class="reset-btn" onclick="cancellaPrevisione()" title="Resetta">
            <svg class="icon reset-icon" viewBox="0 0 24 24">
              <path
                d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"
              ></path>
              <path d="M3 3v5h5"></path>
            </svg>
            Cancella Previsione
          </button>
        </div>
        <div class="sidebar-content">
          <!-- Prediction Length -->
          <div class="filter-section">
            <div class="filter-title">Prediction Length (1-1024)</div>
            <input
              type="number"
              id="predictionLength"
              class="select-box"
              min="1"
              max="1024"
              value="36"
            />
          </div>

          <!-- Prediction Precision -->
          <div class="filter-section">
            <div class="filter-title">Prediction Precision (0-10)</div>
            <input
              type="number"
              id="predictionPrecision"
              class="select-box"
              min="0"
              max="10"
              value="5"
            />
          </div>

          <!-- 1. AMBITO MENSILE (Multi-Select) -->
          <details class="filter-accordion" open>
            <summary>Ambito Mensile</summary>
            <div class="accordion-content">
              <div class="checkbox-group">
                <label class="checkbox-item">
                  <input type="radio" name="ambitoMode" value="all" checked />
                  Tutti
                </label>

                <label class="checkbox-item">
                  <input type="radio" name="ambitoMode" value="strutture" />
                  Solo Strutture
                </label>

                <label class="checkbox-item">
                  <input type="radio" name="ambitoMode" value="luoghi" />
                  Solo Luoghi
                </label>
              </div>
              <div class="scrollable-filter" id="ambitiContainer">
                <!-- STRUTTURE -->
                <label class="checkbox-item">
                  <input
                    type="checkbox"
                    class="ambito-item strutture"
                    value="Esercizi alberghieri"
                    checked
                  />
                  Esercizi alberghieri
                </label>

                <label class="checkbox-item">
                  <input
                    type="checkbox"
                    class="ambito-item strutture"
                    value="Esercizi extralberghieri"
                    checked
                  />
                  Esercizi extralberghieri
                </label>

                <!-- LUOGHI -->
                <label class="checkbox-item">
                  <input
                    type="checkbox"
                    class="ambito-item luoghi"
                    value="Trento, Monte Bondone e Altopiano di Pinè"
                    checked
                  />
                  Trento, Monte Bondone e Altopiano di Pinè
                </label>

                <label class="checkbox-item">
                  <input
                    type="checkbox"
                    class="ambito-item luoghi"
                    value="Val di Fiemme e Val di Cembra"
                    checked
                  />
                  Val di Fiemme e Val di Cembra
                </label>

                <label class="checkbox-item">
                  <input
                    type="checkbox"
                    class="ambito-item luoghi"
                    value="Val di Fassa"
                    checked
                  />
                  Val di Fassa
                </label>
              </div>
            </div>
          </details>
         

          <!-- 3. METRICA (Serie Dati) -->
          <details class="filter-accordion" open>
            <summary>Metrica</summary>
            <div class="accordion-content">
              <div class="checkbox-group">
                <label class="checkbox-item">
                  <input
                    type="checkbox"
                    id="chkPresenze"
                    class="metrica-item"
                    value="Presenze"
                    checked
                  />
                  <span
                    style="
                      display: inline-block;
                      width: 10px;
                      height: 10px;
                      border-radius: 3px;
                      background: var(--accent);
                      margin-right: 8px;
                    "
                  ></span>
                  Presenze
                </label>
                <label class="checkbox-item">
                  <input
                    type="checkbox"
                    id="chkArrivi"
                    class="metrica-item"
                    value="Arrivi"
                    checked
                  />
                  <span
                    style="
                      display: inline-block;
                      width: 10px;
                      height: 10px;
                      border-radius: 3px;
                      background: var(--secondary);
                      margin-right: 8px;
                    "
                  ></span>
                  Arrivi
                </label>
              </div>
            </div>
          </details>

          <!-- 4. PERIODO (Data Partenza - Data Arrivo) -->
          <div class="filter-section" style="margin-top: 12px">
            <div class="filter-title">
              Periodo
              <div class="toggle-pill">
                <button
                  class="pill-btn active"
                  id="btnPeriodYear"
                  onclick="setPeriodType('year')"
                >
                  Anno
                </button>
                <button
                  class="pill-btn"
                  id="btnPeriodMonth"
                  onclick="setPeriodType('month')"
                >
                  Mese
                </button>
              </div>
            </div>

            <!-- View ANNO -->
            <div class="periodo-row" id="periodYearRow">
              <select class="period-select" id="startYear"></select>
              <span class="period-separator">-</span>
              <select class="period-select" id="endYear"></select>
            </div>

            <!-- View MESE -->
            <div
              id="periodMonthRow"
              style="display: none; flex-direction: column; gap: 8px"
            >
              <div style="display: flex; align-items: center; gap: 8px">
                <span
                  style="
                    font-size: 0.75rem;
                    color: var(--text-tertiary);
                    width: 20px;
                  "
                  >Dal</span
                >
                <select class="period-select" id="startMonthM"></select>
                <select class="period-select" id="startYearM"></select>
              </div>
              <div style="display: flex; align-items: center; gap: 8px">
                <span
                  style="
                    font-size: 0.75rem;
                    color: var(--text-tertiary);
                    width: 20px;
                  "
                  >Al</span
                >
                <select class="period-select" id="endMonthM"></select>
                <select class="period-select" id="endYearM"></select>
              </div>
            </div>
          </div>

          <!-- Generate Button -->
          <div class="filter-section" style="margin-top: 30px">
            <button
              class="mode-btn generate"
              style="width: 100%"
              onclick="generateForecast()"
            >
              Genera Forecast ✨
            </button>
          </div>
        </div>
      </aside>

      <!-- MAIN CONTENT -->
      <main class="main-content">
        <header class="top-bar">
          <div id="leftButtons" class="left-buttons">
            <button
              class="toggle-btn"
              id="btnToggleLeftFilter"
              onclick="toggleSidebar('leftfilter')"
              title="Menu Filtri"
            >
              <svg class="icon" viewBox="0 0 24 24">
                <line x1="4" y1="12" x2="20" y2="12"></line>
                <line x1="4" y1="6" x2="20" y2="6"></line>
                <line x1="4" y1="18" x2="20" y2="18"></line>
              </svg>
            </button>
            <button
              class="toggle-btn"
              id="btnToggleLeftGenerate"
              onclick="toggleSidebar('leftgenerate')"
              title="Menu Generazione"
            >
              <svg
                class="icon"
                width="800px"
                height="800px"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M7.99903 20.0002L14.9998 12.9969C16.1037 11.8926 16.1011 10.1018 14.994 9.00068C13.8916 7.90418 12.11 7.90587 11.0097 9.00446L4.00217 16.001C2.89666 17.1048 2.89595 18.896 4.0006 20.0006C5.10478 21.1048 6.89505 21.1046 7.99903 20.0002ZM11 11L13 13L14 12C14.5523 11.4477 14.5523 10.5523 14 10C13.4477 9.44772 12.5523 9.44772 12 10L11 11Z"
                  fill="#000000"
                />
                <path
                  d="M6.75851 4.89658C6.82492 4.64991 7.1749 4.64991 7.24131 4.89658L7.59888 6.22462C7.62205 6.31066 7.68925 6.37786 7.77529 6.40103L9.10333 6.7586C9.35 6.82501 9.35 7.17499 9.10333 7.2414L7.77529 7.59897C7.68925 7.62214 7.62205 7.68934 7.59888 7.77538L7.24131 9.10342C7.1749 9.35009 6.82492 9.35009 6.75851 9.10342L6.40093 7.77538C6.37777 7.68934 6.31056 7.62214 6.22453 7.59897L4.89649 7.2414C4.64982 7.17499 4.64982 6.82501 4.89649 6.7586L6.22453 6.40103C6.31056 6.37786 6.37777 6.31066 6.40093 6.22462L6.75851 4.89658Z"
                  fill="#000000"
                />
                <path
                  d="M16.7585 3.89658C16.8249 3.64991 17.1749 3.64991 17.2413 3.89658L17.5989 5.22462C17.622 5.31066 17.6893 5.37786 17.7753 5.40103L19.1033 5.7586C19.35 5.82501 19.35 6.17499 19.1033 6.2414L17.7753 6.59897C17.6893 6.62214 17.622 6.68934 17.5989 6.77538L17.2413 8.10342C17.1749 8.35009 16.8249 8.35009 16.7585 8.10342L16.4009 6.77538C16.3778 6.68934 16.3106 6.62214 16.2245 6.59897L14.8965 6.2414C14.6498 6.17499 14.6498 5.82501 14.8965 5.7586L16.2245 5.40103C16.3106 5.37786 16.3778 5.31066 16.4009 5.22462L16.7585 3.89658Z"
                  fill="#000000"
                />
                <path
                  d="M17.7585 12.8966C17.8249 12.6499 18.1749 12.6499 18.2413 12.8966L18.5989 14.2246C18.622 14.3107 18.6893 14.3779 18.7753 14.401L20.1033 14.7586C20.35 14.825 20.35 15.175 20.1033 15.2414L18.7753 15.599C18.6893 15.6221 18.622 15.6893 18.5989 15.7754L18.2413 17.1034C18.1749 17.3501 17.8249 17.3501 17.7585 17.1034L17.4009 15.7754C17.3778 15.6893 17.3106 15.6221 17.2245 15.599L15.8965 15.2414C15.6498 15.175 15.6498 14.825 15.8965 14.7586L17.2245 14.401C17.3106 14.3779 17.3778 14.3107 17.4009 14.2246L17.7585 12.8966Z"
                  fill="#000000"
                />
              </svg>
            </button>
          </div>
          <div class="header-center">TourismForecast</div>

          <div style="display: flex; gap: 10px; align-items: center">
            <div
              class="theme-switch"
              id="themeSwitch"
              data-mode="light"
              onclick="toggleTheme()"
              title="Cambia Tema"
            >
              <div class="theme-icon sun">
                <svg class="icon" style="width: 16px" viewBox="0 0 24 24">
                  <circle cx="12" cy="12" r="5"></circle>
                  <line x1="12" y1="1" x2="12" y2="3"></line>
                  <line x1="12" y1="21" x2="12" y2="23"></line>
                  <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                  <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                  <line x1="1" y1="12" x2="3" y2="12"></line>
                  <line x1="21" y1="12" x2="23" y2="12"></line>
                  <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                  <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
              </div>
              <div class="theme-icon moon">
                <svg class="icon" style="width: 16px" viewBox="0 0 24 24">
                  <path
                    d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"
                  ></path>
                </svg>
              </div>
            </div>

            <button
              class="toggle-btn"
              id="btnToggleRight"
              onclick="toggleSidebar('right')"
              title="Guida"
            >
              <svg class="icon" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12.01" y2="8"></line>
              </svg>
            </button>
          </div>
        </header>

        <div class="content-scrollable">
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">
                        <h2 id="chartMainTitle">Seleziona un Ambito</h2>
                        <p id="chartSubTitle">Filtra per target e periodo</p>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="mainChart"></canvas>
                    <div id="chartPlaceholder" class="chart-placeholder">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg>
                        <p>Non immaginare il futuro, prevedilo!</p>
                    </div>
                </div>
            </div>

            <div class="mode-controls">
                <button class="mode-btn active" id="btnHistory" onclick="aggiornaTimeFilter('history')">Storico</button>
                <button class="mode-btn generate" id="btnForecast" onclick="aggiornaTimeFilter('forecast')">Genera AI ✨</button>
                <button class="mode-btn" id="btnAll" onclick="aggiornaTimeFilter('both')">Completo</button>
            </div>
        </div>
      </main>

      <!-- SIDEBAR DESTRA -->
      <aside class="sidebar-right collapsed" id="sidebarRight">
        <div class="resizer resizer-right" id="resizerRight"></div>
        <div class="sidebar-header" style="justify-content: center">
          <span class="brand-title" style="color: var(--text-primary)"
            >GUIDA RAPIDA</span
          >
        </div>
        <div class="info-container">
          <div class="info-card">
            <div class="info-title">
              <div class="info-icon-wrapper">
                <svg class="icon" viewBox="0 0 24 24">
                  <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                </svg>
              </div>
              How To Use
            </div>
            <div class="info-text">
              Benvenuto nella dashboard predittiva del turismo in Trentino.
            </div>
            <ul class="step-list">
              <li>
                <strong>Filtra:</strong> Usa il pannello sinistro per
                selezionare ambito, tipologia e origine.
              </li>
              <li>
                <strong>Anni:</strong> Seleziona manualmente gli anni o usa i
                range rapidi (5 anni).
              </li>
              <li>
                <strong>Modalità:</strong>
                <div
                  style="
                    margin-top: 4px;
                    padding-left: 8px;
                    font-size: 0.85rem;
                    color: var(--text-tertiary);
                  "
                >
                  • Storico: Dati consolidati fino al 2024.<br />
                  • Generate AI: Algoritmo predittivo con cicli economici.
                </div>
              </li>
              <li>
                <strong>Reset:</strong> Usa il tasto "Reset" per cancellare la
                selezione e il grafico.
              </li>
            </ul>
          </div>
        </div>
      </aside>
    </div>
  </body>
  <script src="{{ url_for('static', filename='dati_default.js') }}"></script>
  <script src="{{ url_for('static', filename='filtra.js') }}"></script>
  <script src="{{ url_for('static', filename='generazione.js') }}"></script>
  <script src="{{ url_for('static', filename='script.js') }}"></script>
</html>
